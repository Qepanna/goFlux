<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>goFlux: a user-friendly GHG fluxes calculation tool — goFlux • goFlux</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="goFlux: a user-friendly GHG fluxes calculation tool — goFlux"><meta property="og:description" content="A wrapper function to calculate GHG fluxes from static chamber measurements.
Calculates linear (LM.flux) and non-linear
fluxes (Hutchinson and Mosier model; HM.flux),
from a variety of greenhouse gasses (
CO2,
CH4,
N2O,
NH3, CO, and
H2O)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">goFlux</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>goFlux: a user-friendly GHG fluxes calculation tool</h1>

    <div class="hidden name"><code>goFlux.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>A wrapper function to calculate GHG fluxes from static chamber measurements.
Calculates linear (<code><a href="LM.flux.html">LM.flux</a></code>) and non-linear
fluxes (Hutchinson and Mosier model; <code><a href="HM.flux.html">HM.flux</a></code>),
from a variety of greenhouse gasses (
CO<sub>2</sub>,
CH<sub>4</sub>,
N<sub>2</sub>O,
NH<sub>3</sub>, CO, and
H<sub>2</sub>O).</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">goFlux</span><span class="op">(</span></span>
<span>  <span class="va">dataframe</span>,</span>
<span>  <span class="va">gastype</span>,</span>
<span>  H2O_col <span class="op">=</span> <span class="st">"H2O_ppm"</span>,</span>
<span>  prec <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  Area <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  offset <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  Vtot <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  Vcham <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  Pcham <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  Tcham <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  k.mult <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  warn.length <span class="op">=</span> <span class="fl">60</span>,</span>
<span>  k.min <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-dataframe">dataframe<a class="anchor" aria-label="anchor" href="#arg-dataframe"></a></dt>
<dd><p>a data.frame containing gas measurements (see <code>gastype</code>
below), water vapor measurements (see <code>H2O_col</code> below)
and the following columns: <code>UniqueID</code>, <code>Etime</code>,
<code>Vtot</code>, <code>Area</code>, <code>Pcham</code>, <code>Tcham</code> and
<code>flag</code> (see the parameters <code>Vtot</code>, <code>Area</code>,
<code>Pcham</code> and <code>Tcham</code> below for more details).
<code>chamID</code> may be used instead of <code>UniqueID</code>.</p></dd>


<dt id="arg-gastype">gastype<a class="anchor" aria-label="anchor" href="#arg-gastype"></a></dt>
<dd><p>character string; specifies which column should be used for the
flux calculations. Must be one of the following: "CO2dry_ppm",
"CH4dry_ppb", "COdry_ppb", "N2Odry_ppb", "NH3dry_ppb", "NO_ppb",
"NO2_ppb" or "H2O_ppm".</p></dd>


<dt id="arg-h-o-col">H2O_col<a class="anchor" aria-label="anchor" href="#arg-h-o-col"></a></dt>
<dd><p>character string; specifies which column should be used to
subtract the effect of water vapor in the chamber space.
Default is <code>H2O_col = "H2O_ppm"</code>.</p></dd>


<dt id="arg-prec">prec<a class="anchor" aria-label="anchor" href="#arg-prec"></a></dt>
<dd><p>numerical value; precision of the instruments. Units must be the
same as <code>gastype</code>. With the default <code>prec = NULL</code>,
instrument precision for each gas must be provided in
<code>dataframe</code>.</p></dd>


<dt id="arg-area">Area<a class="anchor" aria-label="anchor" href="#arg-area"></a></dt>
<dd><p>numerical value; area of the soil surface inside the chamber
(cm<sup>2</sup>).
Alternatively, provide the column <code>Area</code> in <code>dataframe</code>
if <code>Area</code> is different between samples.</p></dd>


<dt id="arg-offset">offset<a class="anchor" aria-label="anchor" href="#arg-offset"></a></dt>
<dd><p>(optional) numerical value; height between the soil surface and
the chamber (cm). Alternatively, provide the column <code>offset</code>
in <code>dataframe</code> if <code>offset</code> is different between samples.
<code>offset</code> is only used if <code>Vtot</code> is missing.</p></dd>


<dt id="arg-vtot">Vtot<a class="anchor" aria-label="anchor" href="#arg-vtot"></a></dt>
<dd><p>numerical value; total volume inside the chamber, tubes, instruments,
etc. (L). Alternatively, provide the column <code>Vtot</code> in
<code>dataframe</code> if <code>Vtot</code> is different between samples. If
<code>Vtot</code> is missing, the function will calculate it from
<code>Area</code>, <code>Vcham</code> and <code>offset</code>.</p></dd>


<dt id="arg-vcham">Vcham<a class="anchor" aria-label="anchor" href="#arg-vcham"></a></dt>
<dd><p>(optional) numerical value; volume inside the chamber, tubes and
instruments (L). Alternatively, provide the column <code>Vcham</code>
in <code>dataframe</code> if <code>Vcham</code> is different between samples.
<code>Vhcam</code> is only used if <code>Vtot</code> is missing.</p></dd>


<dt id="arg-pcham">Pcham<a class="anchor" aria-label="anchor" href="#arg-pcham"></a></dt>
<dd><p>numerical value; pressure inside the chamber (kPa).
Alternatively, provide the column <code>Pcham</code> in <code>dataframe</code>
if <code>Pcham</code> is different between samples. If <code>Pcham</code> is
not provided, normal atmospheric pressure (101.325 kPa) is used.</p></dd>


<dt id="arg-tcham">Tcham<a class="anchor" aria-label="anchor" href="#arg-tcham"></a></dt>
<dd><p>numerical value; temperature inside the chamber (Celsius).
Alternatively, provide the column <code>Tcham</code> in <code>dataframe</code>
if <code>Tcham</code> is different between samples. If <code>Tcham</code> is
not provided, 15°C is used as default.</p></dd>


<dt id="arg-k-mult">k.mult<a class="anchor" aria-label="anchor" href="#arg-k-mult"></a></dt>
<dd><p>numerical value; a multiplier for the allowed kappa-max.
Default setting is no multiplier (<code>k.mult = 1</code>).
<code>k.mult</code> cannot be negative and must be smaller or
equal to 10.</p></dd>


<dt id="arg-warn-length">warn.length<a class="anchor" aria-label="anchor" href="#arg-warn-length"></a></dt>
<dd><p>numerical value; limit under which a measurement is
flagged for being too short (<code>nb.obs &lt; warn.length</code>).</p></dd>


<dt id="arg-k-min">k.min<a class="anchor" aria-label="anchor" href="#arg-k-min"></a></dt>
<dd><p>numerical value; a lower boundary value for kappa in the HM model.
Default is <code>k.min = 0</code></p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>Returns a data frame with 28 columns: a <code>UniqueID</code> per
measurement, 11 columns for the linear model results (linear flux estimate
(<code><a href="LM.flux.html">LM.flux</a></code>), initial gas concentration
(<code>LM.C0</code>), final gas concentration (<code>LM.Ct</code>), slope of linear
regression (<code>LM.slope</code>), mean absolute error (<code>LM.MAE</code>), root mean
square error (<code>LM.RMSE</code>), Akaike's information criterion corrected for
small sample size (<code>LM.AICc</code>), standard error (<code>LM.SE</code>), relative
standard error (<code>LM.se.rel</code>), coefficient of determination (<code>LM.r2</code>),
and <em>p-value</em> (<code>LM.p.val</code>)), 11 columns for the non-linear model
results (non-linear flux estimate (<code><a href="HM.flux.html">HM.flux</a></code>),
initial gas concentration (<code>HM.C0</code>), the assumed concentration of
constant gas source below the surface (<code>HM.Ci</code>), slope at <code>t=0</code>
(<code>HM.slope</code>), mean absolute error (<code>HM.MAE</code>), root mean square error
(<code>HM.RMSE</code>), Akaike's information criterion corrected for small sample
size (<code>HM.AICc</code>), standard error (<code>HM.SE</code>), relative standard error
(<code>HM.se.rel</code>), coefficient of determination (<code>HM.r2</code>), and curvature
(kappa; <code>HM.k</code>), as well as the minimal detectable flux
(<code><a href="MDF.html">MDF</a></code>), the precision of the instrument
(<code>prec</code>), the flux term (<code><a href="flux.term.html">flux.term</a></code>),
kappa-max (<code><a href="k.max.html">k.max</a></code>), the g factor (g.fact;
<code><a href="g.factor.html">g.factor</a></code>), the number of observations used
(<code>nb.obs</code>) and the true initial gas concentration (<code>C0</code>) and final
gas concentration (<code>Ct</code>).</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>Flux estimate units are
µmol m<sup>-2</sup>s<sup>-1</sup>
(if initial concentration is ppm, e.g. CO2dry_ppm) and
nmol m<sup>-2</sup>s<sup>-1</sup>
(if initial concentration is ppb, e.g. CH4dry_ppb).</p>
<p>The <code>goFlux</code> function calculates flux estimates
from the linear model (LM) and the Hutchinson and Mosier model (HM). The HM
model is a non-linear model, whose curvature is controlled by the parameter
kappa. A large kappa returns a strong curvature. A maximum threshold for this
parameter, kappa-max (<code><a href="k.max.html">k.max</a></code>), can be calculated
from the linear flux estimate (<code><a href="LM.flux.html">LM.flux</a></code>), the
minimal detectable flux (<code><a href="MDF.html">MDF</a></code>) and the time of
chamber closure. This limit of kappa-max is included in the
<code>goFlux</code> function, so that the non-linear flux
estimate cannot exceed this maximum curvature. Inversely, one can set a
minimal threshold for kappa: to allow for a log-like curvature, set
<code>k.min</code> below 0 (ex. -1).</p>
<p>All flux estimates, including the <code><a href="MDF.html">MDF</a></code>, are
obtained from the multiplication of the slope and the
<code><a href="flux.term.html">flux.term</a></code>, which is used to correct the
pressure inside the chamber (due to water vapor), as well as convert the
units to obtain a term in nmol or
µmol m<sup>-2</sup>s<sup>-1</sup>.</p>
<p>The argument <code>Area</code> is in (cm<sup>2</sup>),
but the output units from <code>goFlux</code> are in
(m<sup>2</sup>). This is due to the
conversion from (cm<sup>2</sup>)
to (m<sup>2</sup>) within the
function. This means that there is a factor of 10,000 to convert from
(cm<sup>2</sup>)
to (m<sup>2</sup>). This is important
to take into account if one would provide something else than an <code>Area</code>
in (cm<sup>2</sup>) to the function.
For example, with incubated soil samples, one may provide an amount of soil
(kg) instead of an area in the column <code>Area</code>. To get the right units in
that case, multiply the kilograms of soil by 10,000 to remove the conversion
from (cm<sup>2</sup>) to
(m<sup>2</sup>).</p>
<p>In <code>gastype</code>, the gas species listed are the ones for which this package
has been adapted. Please write to the maintainer of this package for
adaptation of additional gases.</p>
<p><code>warn.length</code> is the limit below which the chamber closure time is
flagged for being too short (<code>nb.obs &lt; warn.length</code>). Portable
greenhouse gas analyzers typically measure at a frequency of 1 Hz. Therefore,
for the default setting of <code>warn.length = 60</code>, the chamber closure time
should be approximately one minute (60 seconds). If the number of
observations is smaller than the threshold, a warning is printed: e.g. "Low
number of observations: UniqueID X has 59 observations".</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Hüppi et al. (2018). Restricting the nonlinearity parameter in
soil greenhouse gas flux calculation for more reliable flux estimates.
<em>PloS one</em>, 13(7), e0200876.</p>
<p>Hutchinson and Mosier (1981). Improved soil cover method for
field measurement of nitrous oxide fluxes.
<em>Soil Science Society of America Journal</em>, 45(2), 311-316.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>Look up the functions <code><a href="MDF.html">MDF</a></code>,
         <code><a href="flux.term.html">flux.term</a></code>,
         <code><a href="g.factor.html">g.factor</a></code>,
         <code><a href="k.max.html">k.max</a></code>,
         <code><a href="HM.flux.html">HM.flux</a></code> and
         <code><a href="LM.flux.html">LM.flux</a></code> of this package for more
         information about these parameters.</p>
<p>See also the import functions to find the
         default instrument precision for each instrument:
         <code><a href="DX4015_import.html">import.DX4015</a></code>,
         <code><a href="EGM5_import.html">import.EGM5</a></code>,
         <code><a href="G2508_import.html">import.G2508</a></code>,
         <code><a href="G4301_import.html">import.G4301</a></code>,
         <code><a href="GAIA_import.html">import.GAIA</a></code>,
         <code><a href="LI6400_import.html">import.LI6400</a></code>,
         <code><a href="LI7810_import.html">import.LI7810</a></code>,
         <code><a href="LI7820_import.html">import.LI7820</a></code>,
         <code><a href="LI8100_import.html">import.LI8100</a></code>,
         <code><a href="LI8200_import.html">import.LI8200</a></code>,
         <code><a href="N2OM1_import.html">import.N2OM1</a></code>,
         <code><a href="uCH4_import.html">import.uCH4</a></code>,
         <code><a href="uN2O_import.html">import.uN2O</a></code>,
         <code><a href="LGR_import.html">import.UGGA</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">manID.UGGA</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">CO2_flux</span> <span class="op">&lt;-</span> <span class="fu">goFlux</span><span class="op">(</span><span class="va">manID.UGGA</span>, <span class="st">"CO2dry_ppm"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |======================================================================| 100%</span>
<span class="r-in"><span><span class="va">CH4_flux</span> <span class="op">&lt;-</span> <span class="fu">goFlux</span><span class="op">(</span><span class="va">manID.UGGA</span>, <span class="st">"CH4dry_ppb"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |======================================================================| 100%</span>
<span class="r-in"><span><span class="va">H2O_flux</span> <span class="op">&lt;-</span> <span class="fu">goFlux</span><span class="op">(</span><span class="va">manID.UGGA</span>, <span class="st">"H2O_ppm"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |======================================================================| 100%</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Karelle Rheault, Klaus Steenberg Larsen.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer></div>






  </body></html>

