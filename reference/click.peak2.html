<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Manual identification of start and end of gas measurements — click.peak2 • goFlux</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Manual identification of start and end of gas measurements — click.peak2"><meta property="og:description" content="Identify the start and the end of a measurement by clicking on them in a
scatter plot. First apply the function obs.win to
identify the observation window of each measurement and then use the function
click.peak2 (see examples below)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">goFlux</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Manual identification of start and end of gas measurements</h1>

    <div class="hidden name"><code>click.peak2.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Identify the start and the end of a measurement by clicking on them in a
scatter plot. First apply the function <code><a href="obs.win.html">obs.win</a></code> to
identify the observation window of each measurement and then use the function
<code>click.peak2</code> (see examples below).</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">click.peak2</span><span class="op">(</span></span>
<span>  <span class="va">ow.list</span>,</span>
<span>  gastype <span class="op">=</span> <span class="st">"CO2dry_ppm"</span>,</span>
<span>  sleep <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  plot.lim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">380</span>, <span class="fl">1000</span><span class="op">)</span>,</span>
<span>  seq <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  warn.length <span class="op">=</span> <span class="fl">60</span>,</span>
<span>  save.plots <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  width <span class="op">=</span> <span class="fl">14</span>,</span>
<span>  height <span class="op">=</span> <span class="fl">8</span>,</span>
<span>  abline <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  abline_corr <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-ow-list">ow.list<a class="anchor" aria-label="anchor" href="#arg-ow-list"></a></dt>
<dd><p>list of data.frame; output from the function
<code><a href="obs.win.html">obs.win</a></code>. Must contain the columns
<code>gastype</code> (see below), <code>POSIX.time</code> and <code>UniqueID</code>.</p></dd>


<dt id="arg-gastype">gastype<a class="anchor" aria-label="anchor" href="#arg-gastype"></a></dt>
<dd><p>character string; specifies which gas should be displayed on
the plot to manually select start time and end time of
measurements. Must be one of the following: "CO2dry_ppm",
"COdry_ppb", "CH4dry_ppb", "N2Odry_ppb", "NO2dry_ppb", "NOdry_ppb",
"NH3dry_ppb" or "H2O_ppm". Default is "CO2dry_ppm".</p></dd>


<dt id="arg-sleep">sleep<a class="anchor" aria-label="anchor" href="#arg-sleep"></a></dt>
<dd><p>numerical value; delay before closing the resulting plot. Grants
a delay between measurements to visually inspect the output
before processing the next measurement. Sleep must be shorter
than 10 seconds. If <code>sleep = NULL</code>, the  plots will not close.</p></dd>


<dt id="arg-plot-lim">plot.lim<a class="anchor" aria-label="anchor" href="#arg-plot-lim"></a></dt>
<dd><p>numerical vector of length 2; sets the Y axis limits in the
plots. Default values are set for a typical gas measurement
of "CO2dry_ppm" from soils: <code>plot.lim = c(380,1000)</code>.</p></dd>


<dt id="arg-seq">seq<a class="anchor" aria-label="anchor" href="#arg-seq"></a></dt>
<dd><p>a numerical sequence that indicates objects in a list. By default,
<code>seq = NULL</code> and the function loops through all data frames
in <code>ow.list</code>.</p></dd>


<dt id="arg-warn-length">warn.length<a class="anchor" aria-label="anchor" href="#arg-warn-length"></a></dt>
<dd><p>numerical value; limit under which a measurement is flagged
for being too short (<code>nb.obs &lt; warn.length</code>). Default
value is <code>warn.length = 60</code>.</p></dd>


<dt id="arg-save-plots">save.plots<a class="anchor" aria-label="anchor" href="#arg-save-plots"></a></dt>
<dd><p>character string; a file path with the extension .pdf to
save the plots produced with click.peak2. By default,
<code>save.plot = NULL</code> and plots are not saved.</p></dd>


<dt id="arg-width">width<a class="anchor" aria-label="anchor" href="#arg-width"></a></dt>
<dd><p>numerical value; width of the pop-up window.</p></dd>


<dt id="arg-height">height<a class="anchor" aria-label="anchor" href="#arg-height"></a></dt>
<dd><p>numerical value; height of the pop-up window.</p></dd>


<dt id="arg-abline">abline<a class="anchor" aria-label="anchor" href="#arg-abline"></a></dt>
<dd><p>logical; if TRUE (default), blue vertical lines indicate
<code>start.time</code> and <code>end.time</code> on both plots.</p></dd>


<dt id="arg-abline-corr">abline_corr<a class="anchor" aria-label="anchor" href="#arg-abline-corr"></a></dt>
<dd><p>logical; if TRUE (default), red vertical lines indicate
<code>start.time_corr</code> and <code>end.time_corr</code> on validation plot.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A data.frame, identical to an unlisted version of the input
         <code>ow.list</code>, with the additional columns <code>flag</code>, <code>Etime</code>,
         <code>start.time_corr</code>, <code>end.time_corr</code> and <code>obs.length_corr</code>.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The argument <code>plot.lim</code> is used to remove any data points below and
above the plot limits for a better view of the scatter plot. If the gas
measurements are larger than the minimum or smaller than the maximum plot
limit values, then the plot will automatically zoom in and adjust to those
values. The default plot limits are set for a typical gas measurement of
"CO2dry_ppm" from a soil respiration measurement: <code>plot.lim = c(380,1000)</code>,
where 380 ppm is the minimum plotted concentration, which should be close to
atmospheric concentration, and 1000 ppm is the maximum plotted concentration,
which correspond to a maximal accumulated concentration in the chamber before
considering it an outlier (e.g. caused by breath or gas bubble). For other
gasses, the user must specify the plot limits themselves. Here are some
suggestions of plot limits for the other gases:</p><ul><li><p>"CH4dry_ppb": <code>plot.lim = c(2200, 1800)</code></p></li>
<li><p>"N2Odry_ppb": <code>plot.lim = c(250, 500)</code></p></li>
<li><p>"NH3dry_ppb": <code>plot.lim = c(0, 200)</code></p></li>
<li><p>"COdry_ppb": <code>plot.lim = c(0, 200)</code></p></li>
<li><p>"H2O_ppm": <code>plot.lim = c(10000, 20000)</code></p></li>
</ul><p>These values will vary depending on ecosystem type and chamber application scheme.</p>
<p>IMPORTANT! This function makes use of the function <code><a href="https://rdrr.io/r/graphics/identify.html" class="external-link">identify</a></code>
which is only supported on screen devices such as X11, windows and quartz.
It is therefore essential to verify that your system options are compatible
with this function before running it, to avoid errors. Use the function
<code>getOption("device")</code> to find which device your system uses.</p>
<p>The argument <code>seq</code> is used to select a subset of data frame from the list
of data frames in <code>ow.list</code>. For example, to apply the function on the
first measurement in the list, set <code>seq = 1</code>, or <code>seq = seq(1,10)</code>
for the first 10 measurements.</p>
<p><code>warn.length</code> is the limit below which the chamber closure time is
flagged for being too short (<code>nb.obs &lt; warn.length</code>). Portable
greenhouse gas analyzers typically measure at a frequency of 1 Hz. Therefore,
for the default setting of <code>warn.length = 60</code>, the chamber closure time
should be approximately one minute (60 seconds). If the number of
observations is smaller than the threshold, a warning is printed: "Number of
observations for UniqueID: 'UniqueID' is X observations".</p>
<p>In <code>gastype</code>, the gas species listed are the ones for which this package
has been adapted. Please write to the maintainer of this package for
adaptation of additional gases.</p>
<p>The arguments <code>width</code> and <code>heigth</code> are used with the function
<code><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.new</a></code> to define the dimensions of the pop-up
window.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>See also <code><a href="obs.win.html">obs.win</a></code> to prepare a list of data.frame.</p>
<p>For an automatic identification of gas measurements, see the function
<code><a href="autoID.html">autoID</a></code>.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>

    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Karelle Rheault, Klaus Steenberg Larsen.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer></div>






  </body></html>

